/* Additional styles to ensure mermaid diagrams are responsive */
.mermaid {
    width: 100%;
    max-width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    margin: 30px 0;
    padding-bottom: 10px;
    display: block;
    position: relative;
    box-sizing: border-box; /* Ensure padding doesn't add to width */
}

.mermaid svg {
    max-width: 100%;
    height: auto !important;
    display: block;
    margin: 0 auto;
}

/* Fix text visibility and sizing in diagrams */
.mermaid svg text,
.mermaid svg .label {
    font-size: 14px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
}

/* Ensure mermaid diagrams don't break layout on mobile */
@media (max-width: 768px) {
    .mermaid {
        font-size: 14px;
        margin: 20px 0;
        padding: 0;
        width: 100%;
        max-width: 100%;
        position: relative;
        overflow-x: auto;
    }
    
    /* Constrain SVG width */
    .mermaid svg {
        max-width: 100%; /* Allow content to determine width */
        margin: 0 auto; /* Center the diagram */
        transform: none;
    }
    
    /* Additional support for clusters and other mermaid elements */
    .mermaid .cluster rect,
    .mermaid .node rect,
    .mermaid .node circle,
    .mermaid .node ellipse,
    .mermaid .node polygon {
        max-width: 100%;
    }
}

@media (max-width: 480px) {
    .mermaid {
        font-size: 12px;
        margin: 20px auto;
        padding: 0 10px;
        width: calc(100% - 20px);
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        position: relative;
        box-sizing: border-box;
    }
    
    .mermaid svg {
        max-width: 100%; /* Fit to container width */
        min-width: 0; /* Override min-width from other styles */
        margin: 0 auto; /* Center the diagram */
        transform: none; /* Reset transform from larger screens */
    }
    
    /* Ensure tables are also responsive */
    .table-wrapper {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        margin: 15px 0;
        padding: 0;
        width: 100%;
        position: relative;
        display: block;
    }
    
    /* Fix for all tables */
    table {
        width: 100%;
        min-width: 0 !important;
        table-layout: fixed;
        font-size: 0.75em;
    }
    
    table th, table td {
        word-break: break-word;
        word-wrap: break-word;
        padding: 4px;
    }
    
    /* Enhance readability of progress indicators on very small devices */
    #reading-progress-bar {
        height: 3px !important;
    }
    
    #reading-progress-percent {
        font-size: 10px !important;
        padding: 2px 4px !important;
        top: 6px !important;
        right: 6px !important;
    }
}